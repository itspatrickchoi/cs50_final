{% extends "layout.html" %} {% block title %} Dashboard {% endblock %} {% block
main %}
<!-- <div class="containter">
  <img
    src="../static/images/logo.png"
    alt="PC-logo"
    width="30px"
    class="logo"
  />
   {% if message %}
        <p class="message">{{message | safe}}</p>
        {% endif %} 
  <form action="/submit" method="POST">
    <div class="form-group">
      <h3>Customer Name</h3>
      <input
        type="text"
        name="customer"
        class="form-control"
        placeholder="Name of vehicle owner"
      />
    </div>
    <div class="form-group">
      <h3>Dealer</h3>
      <label for="select">Select:</label
      ><select id="select" name="dealer">
        <option value="">Select Dealer</option>
        <option value="Tom Smith">Tom Smith</option>
      </select>
    </div>
    <div class="form-group">
      <h3>Comments about your experience</h3>
      <textarea
        name="comments"
        id=""
        cols="30"
        rows="10"
        placeholder="Tell us what you liked and/or did not like"
      ></textarea>
    </div>
    <button class="btn btn-primary" type="submit">Submit</button>
  </form>
</div>
<a href="/frontpage" class="btn btn">Curves</a> -->

<!-- START INDEX PAGE -->
<div
  class="container mx-auto mt-8 flex items-center justify-around"
  id="stats-dashboard"
>
  <div class="clock">
    <div class="hour">
      <div class="hr" id="hr"></div>
    </div>
    <div class="min">
      <div class="mn" id="mn"></div>
    </div>
    <div class="sec">
      <div class="sc" id="sc"></div>
    </div>
  </div>
  <div class="other-stats">
    <div class="weather"></div>
  </div>
  <script id="weather">
    /* For whatever reason I can't use 'location' and have to use city because else I get "Uncaught SyntaxError: Identifier 'location' has already been declared". I haven't used 'location' anywhere else in my file...Ok, after avoiding this error, I found out that the JSON response already has "location" in it. But I couldn't know... */
    const apiData = {
      url: "http://api.weatherapi.com/v1",
      type: "current.json",
      key: "40cd513af8aa446484a92837213011",
      city: "London",
    };

    const { url, type, key, city } = apiData;

    const apiUrl = `${url}/${type}?key=${key}&q=${city}`;

    console.log(apiUrl);

    fetch(apiUrl)
      .then((data) => {
        if (data.ok) {
          return data.json();
        }
        throw new Error("Response not ok.");
      })
      .then((locationRequest) => generateHtml(locationRequest))
      .catch((error) => console.error("Error:", error));

    const generateHtml = (data) => {
      console.log(data);
      console.log(`${data.location.name}`);
      const html = `
        <div class="weather-location">${data.location.name},${data.location.country}</div>
        <div class="details">
            <span>Tmp: ${data.current.temp_c} °C</span>
            <span>Feels like: ${data.current.feelslike_c} °C</span>
        </div>
    `;
      const weatherDiv = document.querySelector(".weather");
      weatherDiv.innerHTML = html;
    };
  </script>
  <script type="text/javascript">
    const deg = 6;
    const hr = document.querySelector("#hr");
    const mn = document.querySelector("#mn");
    const sc = document.querySelector("#sc");

    setInterval(() => {
      let day = new Date();
      let hh = day.getHours() * 30;
      let mm = day.getMinutes() * deg;
      let ss = day.getSeconds() * deg;

      hr.style.transform = `rotateZ(${hh + mm / 12}deg)`;
      mn.style.transform = `rotateZ(${mm}deg)`;
      sc.style.transform = `rotateZ(${ss}deg)`;
    });
  </script>
</div>
{% endblock %}
